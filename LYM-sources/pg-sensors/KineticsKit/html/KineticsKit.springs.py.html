<!DOCTYPE html  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>springs.py</title>
<meta name="GENERATOR" content="SciTE - www.Scintilla.org" />
<style type="text/css">
.S0 {
	color: #808070;
}
.S1 {
	color: #dd0000;
}
.S2 {
	font-weight: bold;
	color: #007f7f;
}
.S5 {
	font-weight: bold;
	color: #ff7700;
}
.S7 {
	color: #00aa00;
}
.S8 {
	font-weight: bold;
	color: #0000ff;
}
.S9 {
	font-weight: bold;
	color: #7f00aa;
}
.S10 {
	font-weight: bold;
	color: #7f3f00;
}
.S12 {
	color: #7F7F7F;
}
span {
	font-family: 'Verdana';
	color: #000000;
	font-size: 9pt;
}
</style>
</head>
<body bgcolor=#f0f0f8>
<span><span class="S5">import</span><span class="S0"> </span>math<br />
<span class="S5">import</span><span class="S0"> </span>visual<br />
<br />
<br />
<span class="S5">class</span><span class="S0"> </span><span class="S8">_Spring</span><span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Physical model of a spring.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">__init__</span><span class="S10">(</span>self<span class="S10">,</span><span class="S0"> </span>m0<span class="S10">,</span><span class="S0"> </span>m1<span class="S10">,</span><span class="S0"> </span>k<span class="S10">,</span><span class="S0"> </span>l0<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>damping<span class="S10">=</span><span class="S5">None</span><span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Construct a spring.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>m0<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>m0<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>m1<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>m1<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>k<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>k<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span>l0<span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>l0<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>l0<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">else</span><span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>l0<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>mag<span class="S10">(</span>self<span class="S10">.</span>m1<span class="S10">.</span>sphere<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">-</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>damping<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>damping<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>e<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>vector<span class="S10">(</span><span class="S2">0.</span><span class="S10">,</span><span class="S0"> </span><span class="S2">0.</span><span class="S10">,</span><span class="S0"> </span><span class="S2">0.</span><span class="S10">)</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">calcSpringForce</span><span class="S10">(</span>self<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Calculate the spring force.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>delta<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>m1<span class="S10">.</span>sphere<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">-</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>l<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>mag<span class="S10">(</span>delta<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>e<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>norm<span class="S10">(</span>delta<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1"># Fspring = (l - l0) * k</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Fspring<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S10">(</span>l<span class="S0"> </span><span class="S10">-</span><span class="S0"> </span>self<span class="S10">.</span>l0<span class="S10">)</span><span class="S0"> </span><span class="S10">*</span><span class="S0"> </span>self<span class="S10">.</span>k<span class="S0"> </span><span class="S10">*</span><span class="S0"> </span>self<span class="S10">.</span>e<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>m0<span class="S10">.</span>F<span class="S0"> </span><span class="S10">+=</span><span class="S0"> </span>Fspring<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>m1<span class="S10">.</span>F<span class="S0"> </span><span class="S10">-=</span><span class="S0"> </span>Fspring<br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">calcDampingForce</span><span class="S10">(</span>self<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Calculate the damping force.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1"># Fdamping = v in e * dampingFactor</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Fdamping<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>dot<span class="S10">((</span>self<span class="S10">.</span>m1<span class="S10">.</span>v<span class="S0"> </span><span class="S10">-</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>v<span class="S10">),</span><span class="S0"> </span>self<span class="S10">.</span>e<span class="S10">)</span><span class="S0"> </span><span class="S10">*</span><span class="S0"> </span>self<span class="S10">.</span>damping<span class="S0"> </span><span class="S10">*</span><span class="S0"> </span>self<span class="S10">.</span>e<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>m0<span class="S10">.</span>F<span class="S0"> </span><span class="S10">+=</span><span class="S0"> </span>Fdamping<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>m1<span class="S10">.</span>F<span class="S0"> </span><span class="S10">-=</span><span class="S0"> </span>Fdamping<br />
<br />
<br />
<span class="S5">class</span><span class="S0"> </span><span class="S8">CylinderSpring</span><span class="S10">(</span>_Spring<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Visual representation of a spring using multiple cylinders.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">__init__</span><span class="S10">(</span>self<span class="S10">,</span><span class="S0"> </span>m0<span class="S10">,</span><span class="S0"> </span>m1<span class="S10">,</span><span class="S0"> </span>k<span class="S10">,</span><span class="S0"> </span>l0<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>damping<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>radius1<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>radius2<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>segments<span class="S10">=</span><span class="S2">2</span><span class="S10">,</span><span class="S0"> </span>color<span class="S10">=(</span><span class="S2">0.8</span><span class="S10">,</span><span class="S0"> </span><span class="S2">0.8</span><span class="S10">,</span><span class="S0"> </span><span class="S2">0.2</span><span class="S10">),</span><span class="S0"> </span><span class="S10">**</span>keywords<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>_Spring<span class="S10">.</span>__init__<span class="S10">(</span>self<span class="S10">,</span><span class="S0"> </span>m0<span class="S10">,</span><span class="S0"> </span>m1<span class="S10">,</span><span class="S0"> </span>k<span class="S10">,</span><span class="S0"> </span>l0<span class="S10">,</span><span class="S0"> </span>damping<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Construct a cylinder spring.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S5">not</span><span class="S0"> </span>radius1<span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>radius1<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S10">(</span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>radius<span class="S0"> </span><span class="S10">+</span><span class="S0"> </span>self<span class="S10">.</span>m1<span class="S10">.</span>sphere<span class="S10">.</span>radius<span class="S10">)</span><span class="S0"> </span><span class="S10">*</span><span class="S0"> </span><span class="S2">0.2</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>frame<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>frame<span class="S10">()</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>frame<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>frame<span class="S10">.</span>axis<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>m1<span class="S10">.</span>sphere<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">-</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>length<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>mag<span class="S10">(</span>self<span class="S10">.</span>frame<span class="S10">.</span>axis<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>dx<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>length<span class="S0"> </span><span class="S10">/</span><span class="S0"> </span>segments<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S5">not</span><span class="S0"> </span>radius2<span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>radius2<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>radius1<span class="S0"> </span><span class="S10">*</span><span class="S0"> </span><span class="S2">0.8</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>i<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S2">0</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>r<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S5">None</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>tube<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S10">[]</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">for</span><span class="S0"> </span>x<span class="S0"> </span><span class="S5">in</span><span class="S0"> </span>visual<span class="S10">.</span>arange<span class="S10">(</span><span class="S2">0</span><span class="S10">,</span><span class="S0"> </span>length<span class="S0"> </span><span class="S10">-</span><span class="S0"> </span>dx<span class="S10">/</span><span class="S2">2.</span><span class="S10">,</span><span class="S0"> </span>dx<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span>i<span class="S0"> </span><span class="S10">%</span><span class="S0"> </span><span class="S2">2</span><span class="S0"> </span><span class="S10">==</span><span class="S0"> </span><span class="S2">0</span><span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>r<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>radius1<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">else</span><span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>r<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>radius2<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>tube<span class="S10">.</span>append<span class="S10">(</span>visual<span class="S10">.</span>cylinder<span class="S10">(</span>frame<span class="S10">=</span>self<span class="S10">.</span>frame<span class="S10">,</span><span class="S0"> </span>pos<span class="S10">=(</span>x<span class="S10">,</span><span class="S0"> </span><span class="S2">0</span><span class="S10">,</span><span class="S0"> </span><span class="S2">0</span><span class="S10">),</span><span class="S0"> </span>axis<span class="S10">=(</span>dx<span class="S10">,</span><span class="S0"> </span><span class="S2">0</span><span class="S10">,</span><span class="S0"> </span><span class="S2">0</span><span class="S10">),</span><span class="S0"> </span>radius<span class="S10">=</span>r<span class="S10">,</span><span class="S0"> </span>color<span class="S10">=</span>color<span class="S10">,</span><span class="S0"> </span><span class="S10">**</span>keywords<span class="S10">))</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>i<span class="S0"> </span><span class="S10">+=</span><span class="S0"> </span><span class="S2">1</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>count<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>i<br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">update</span><span class="S10">(</span>self<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Update the visual representation of the spring.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>frame<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>frame<span class="S10">.</span>axis<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>m1<span class="S10">.</span>sphere<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">-</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>dx<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>mag<span class="S10">(</span>self<span class="S10">.</span>frame<span class="S10">.</span>axis<span class="S10">)</span><span class="S0"> </span><span class="S10">/</span><span class="S0"> </span>self<span class="S10">.</span>count<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">for</span><span class="S0"> </span>index<span class="S0"> </span><span class="S5">in</span><span class="S0"> </span>range<span class="S10">(</span>self<span class="S10">.</span>count<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">#self.tube[index].x = index * dx</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S12">## cylinder.x was buggy in previous visual modules, therefore:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>tube<span class="S10">[</span>index<span class="S10">].</span>pos<span class="S10">[</span><span class="S2">0</span><span class="S10">]</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>index<span class="S0"> </span><span class="S10">*</span><span class="S0"> </span>dx<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>tube<span class="S10">[</span>index<span class="S10">].</span>axis<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>vector<span class="S10">(</span>dx<span class="S10">,</span><span class="S0"> </span><span class="S2">0</span><span class="S10">,</span><span class="S0"> </span><span class="S2">0</span><span class="S10">)</span><br />
<br />
<br />
<span class="S5">class</span><span class="S0"> </span><span class="S8">RubberSpring</span><span class="S10">(</span>_Spring<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Visual representation of a spring using a single cylinder with variable radius.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">__init__</span><span class="S10">(</span>self<span class="S10">,</span><span class="S0"> </span>m0<span class="S10">,</span><span class="S0"> </span>m1<span class="S10">,</span><span class="S0"> </span>k<span class="S10">,</span><span class="S0"> </span>l0<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>damping<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>radius<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>color<span class="S10">=(</span><span class="S2">0.8</span><span class="S10">,</span><span class="S0"> </span><span class="S2">0.2</span><span class="S10">,</span><span class="S0"> </span><span class="S2">0.8</span><span class="S10">),</span><span class="S0"> </span><span class="S10">**</span>keywords<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>_Spring<span class="S10">.</span>__init__<span class="S10">(</span>self<span class="S10">,</span><span class="S0"> </span>m0<span class="S10">,</span><span class="S0"> </span>m1<span class="S10">,</span><span class="S0"> </span>k<span class="S10">,</span><span class="S0"> </span>l0<span class="S10">,</span><span class="S0"> </span>damping<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Construct a rubber spring.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S5">not</span><span class="S0"> </span>radius<span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>radius<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S10">(</span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>radius<span class="S0"> </span><span class="S10">+</span><span class="S0"> </span>self<span class="S10">.</span>m1<span class="S10">.</span>sphere<span class="S10">.</span>radius<span class="S10">)</span><span class="S0"> </span><span class="S10">*</span><span class="S0"> </span><span class="S2">0.2</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>r0<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>radius<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>cylinder<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>cylinder<span class="S10">(</span>pos<span class="S10">=</span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<span class="S10">,</span><span class="S0"> </span>axis<span class="S10">=</span>self<span class="S10">.</span>m1<span class="S10">.</span>sphere<span class="S10">.</span>pos<span class="S10">-</span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<span class="S10">,</span><span class="S0"> </span>radius<span class="S10">=</span>radius<span class="S10">,</span><span class="S0"> </span>color<span class="S10">=</span>color<span class="S10">,</span><span class="S0"> </span><span class="S10">**</span>keywords<span class="S10">)</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">update</span><span class="S10">(</span>self<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Update the visual representation of the spring.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>cylinder<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>cylinder<span class="S10">.</span>axis<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>m1<span class="S10">.</span>sphere<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">-</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>fact<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>l0<span class="S0"> </span><span class="S10">/</span><span class="S0"> </span>visual<span class="S10">.</span>mag<span class="S10">(</span>self<span class="S10">.</span>cylinder<span class="S10">.</span>axis<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>cylinder<span class="S10">.</span>radius<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>r0<span class="S0"> </span><span class="S10">*</span><span class="S0"> </span>fact<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>fact<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S2">0.5</span><span class="S0"> </span><span class="S10">+</span><span class="S0"> </span>visual<span class="S10">.</span>mag<span class="S10">(</span>self<span class="S10">.</span>cylinder<span class="S10">.</span>axis<span class="S10">)</span><span class="S0"> </span><span class="S10">-</span><span class="S0"> </span>self<span class="S10">.</span>l0<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>cylinder<span class="S10">.</span>color<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S10">(</span>fact<span class="S10">,</span><span class="S0"> </span>fact<span class="S10">,</span><span class="S0"> </span>fact<span class="S10">)</span><br />
<br />
<br />
<span class="S5">class</span><span class="S0"> </span><span class="S8">DoubleHelixSpring</span><span class="S10">(</span>_Spring<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Visual representation of a spring using a double helix.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">__init__</span><span class="S10">(</span>self<span class="S10">,</span><span class="S0"> </span>m0<span class="S10">,</span><span class="S0"> </span>m1<span class="S10">,</span><span class="S0"> </span>k<span class="S10">,</span><span class="S0"> </span>l0<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>damping<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>radius<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>coils<span class="S10">=</span><span class="S2">2</span><span class="S10">,</span><span class="S0"> </span>wireradius<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>spc<span class="S10">=</span><span class="S2">10</span><span class="S10">,</span><span class="S0"> </span>color<span class="S10">=(</span><span class="S2">0.8</span><span class="S10">,</span><span class="S0"> </span><span class="S2">0.8</span><span class="S10">,</span><span class="S0"> </span><span class="S2">0.2</span><span class="S10">),</span><span class="S0"> </span><span class="S10">**</span>keywords<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>_Spring<span class="S10">.</span>__init__<span class="S10">(</span>self<span class="S10">,</span><span class="S0"> </span>m0<span class="S10">,</span><span class="S0"> </span>m1<span class="S10">,</span><span class="S0"> </span>k<span class="S10">,</span><span class="S0"> </span>l0<span class="S10">,</span><span class="S0"> </span>damping<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Construct a double helix spring.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S5">not</span><span class="S0"> </span>radius<span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>radius<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S10">(</span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>radius<span class="S0"> </span><span class="S10">+</span><span class="S0"> </span>self<span class="S10">.</span>m1<span class="S10">.</span>sphere<span class="S10">.</span>radius<span class="S10">)</span><span class="S0"> </span><span class="S10">*</span><span class="S0"> </span><span class="S2">0.2</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>frame<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>frame<span class="S10">()</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>frame<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>frame<span class="S10">.</span>axis<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>m1<span class="S10">.</span>sphere<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">-</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>length<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>mag<span class="S10">(</span>self<span class="S10">.</span>frame<span class="S10">.</span>axis<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S5">not</span><span class="S0"> </span>wireradius<span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>wireradius<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>radius<span class="S0"> </span><span class="S10">*</span><span class="S0"> </span><span class="S2">0.5</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>k<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>coils<span class="S0"> </span><span class="S10">*</span><span class="S0"> </span><span class="S10">(</span><span class="S2">2.</span><span class="S0"> </span><span class="S10">*</span><span class="S0"> </span>math<span class="S10">.</span>pi<span class="S0"> </span><span class="S10">/</span><span class="S0"> </span>length<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>dx<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S10">(</span>length<span class="S0"> </span><span class="S10">/</span><span class="S0"> </span>coils<span class="S10">)</span><span class="S0"> </span><span class="S10">/</span><span class="S0"> </span>spc<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>helix1<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>curve<span class="S10">(</span>frame<span class="S10">=</span>self<span class="S10">.</span>frame<span class="S10">,</span><span class="S0"> </span>radius<span class="S10">=</span>wireradius<span class="S10">,</span><span class="S0"> </span>color<span class="S10">=</span>color<span class="S10">,</span><span class="S0"> </span><span class="S10">**</span>keywords<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>helix2<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>curve<span class="S10">(</span>frame<span class="S10">=</span>self<span class="S10">.</span>frame<span class="S10">,</span><span class="S0"> </span>radius<span class="S10">=</span>wireradius<span class="S10">,</span><span class="S0"> </span>color<span class="S10">=</span>color<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">for</span><span class="S0"> </span>x<span class="S0"> </span><span class="S5">in</span><span class="S0"> </span>visual<span class="S10">.</span>arange<span class="S10">(</span><span class="S2">0</span><span class="S10">,</span><span class="S0"> </span>length<span class="S0"> </span><span class="S10">+</span><span class="S0"> </span>dx<span class="S10">/</span><span class="S2">2.</span><span class="S10">,</span><span class="S0"> </span>dx<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>helix1<span class="S10">.</span>append<span class="S10">(</span><span class="S0"> </span>pos<span class="S10">=(</span>x<span class="S10">,</span><span class="S0"> </span>radius<span class="S10">*</span>math<span class="S10">.</span>sin<span class="S10">(</span>k<span class="S10">*</span>x<span class="S10">),</span><span class="S0"> </span>radius<span class="S10">*</span>math<span class="S10">.</span>cos<span class="S10">(</span>k<span class="S10">*</span>x<span class="S10">))</span><span class="S0"> </span><span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>helix2<span class="S10">.</span>append<span class="S10">(</span><span class="S0"> </span>pos<span class="S10">=(</span>x<span class="S10">,</span><span class="S0"> </span><span class="S10">-</span>radius<span class="S10">*</span>math<span class="S10">.</span>sin<span class="S10">(</span>k<span class="S10">*</span>x<span class="S10">),</span><span class="S0"> </span><span class="S10">-</span>radius<span class="S10">*</span>math<span class="S10">.</span>cos<span class="S10">(</span>k<span class="S10">*</span>x<span class="S10">))</span><span class="S0"> </span><span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>count<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>len<span class="S10">(</span>self<span class="S10">.</span>helix1<span class="S10">.</span>pos<span class="S10">)</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">update</span><span class="S10">(</span>self<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Update the visual representation of the spring.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>frame<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>frame<span class="S10">.</span>axis<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>m1<span class="S10">.</span>sphere<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">-</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>dx<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>mag<span class="S10">(</span>self<span class="S10">.</span>frame<span class="S10">.</span>axis<span class="S10">)</span><span class="S0"> </span><span class="S10">/</span><span class="S0"> </span><span class="S10">(</span>self<span class="S10">.</span>count<span class="S10">-</span><span class="S2">1</span><span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">for</span><span class="S0"> </span>index<span class="S0"> </span><span class="S5">in</span><span class="S0"> </span>range<span class="S10">(</span>self<span class="S10">.</span>count<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>helix1<span class="S10">.</span>x<span class="S10">[</span>index<span class="S10">]</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>index<span class="S0"> </span><span class="S10">*</span><span class="S0"> </span>dx<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>helix2<span class="S10">.</span>x<span class="S10">[</span>index<span class="S10">]</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>index<span class="S0"> </span><span class="S10">*</span><span class="S0"> </span>dx<br />
<br />
<br />
<span class="S5">class</span><span class="S0"> </span><span class="S8">SingleHelixSpring</span><span class="S10">(</span>_Spring<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Visual representation of a spring using a single helix.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;Problematic, because the up-vector is not treated at all.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">__init__</span><span class="S10">(</span>self<span class="S10">,</span><span class="S0"> </span>m0<span class="S10">,</span><span class="S0"> </span>m1<span class="S10">,</span><span class="S0"> </span>k<span class="S10">,</span><span class="S0"> </span>l0<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>damping<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>radius<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>coils<span class="S10">=</span><span class="S2">4</span><span class="S10">,</span><span class="S0"> </span>wireradius<span class="S10">=</span><span class="S5">None</span><span class="S10">,</span><span class="S0"> </span>spc<span class="S10">=</span><span class="S2">10</span><span class="S10">,</span><span class="S0"> </span>color<span class="S10">=(</span><span class="S2">0.8</span><span class="S10">,</span><span class="S0"> </span><span class="S2">0.8</span><span class="S10">,</span><span class="S0"> </span><span class="S2">0.2</span><span class="S10">),</span><span class="S0"> </span><span class="S10">**</span>keywords<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Construct a single helix spring.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>_Spring<span class="S10">.</span>__init__<span class="S10">(</span>self<span class="S10">,</span><span class="S0"> </span>m0<span class="S10">,</span><span class="S0"> </span>m1<span class="S10">,</span><span class="S0"> </span>k<span class="S10">,</span><span class="S0"> </span>l0<span class="S10">,</span><span class="S0"> </span>damping<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S5">not</span><span class="S0"> </span>radius<span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>radius<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S10">(</span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>radius<span class="S0"> </span><span class="S10">+</span><span class="S0"> </span>self<span class="S10">.</span>m1<span class="S10">.</span>sphere<span class="S10">.</span>radius<span class="S10">)</span><span class="S0"> </span><span class="S10">*</span><span class="S0"> </span><span class="S2">0.2</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>frame<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>frame<span class="S10">()</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>frame<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>frame<span class="S10">.</span>axis<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>m1<span class="S10">.</span>sphere<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">-</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>length<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>mag<span class="S10">(</span>self<span class="S10">.</span>frame<span class="S10">.</span>axis<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">if</span><span class="S0"> </span><span class="S5">not</span><span class="S0"> </span>wireradius<span class="S10">:</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>wireradius<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>radius<span class="S0"> </span><span class="S10">*</span><span class="S0"> </span><span class="S2">0.5</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>k<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>coils<span class="S0"> </span><span class="S10">*</span><span class="S0"> </span><span class="S10">(</span><span class="S2">2.</span><span class="S0"> </span><span class="S10">*</span><span class="S0"> </span>math<span class="S10">.</span>pi<span class="S0"> </span><span class="S10">/</span><span class="S0"> </span>length<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>dx<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S10">(</span>length<span class="S0"> </span><span class="S10">/</span><span class="S0"> </span>coils<span class="S10">)</span><span class="S0"> </span><span class="S10">/</span><span class="S0"> </span>spc<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>helix<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>curve<span class="S10">(</span>frame<span class="S10">=</span>self<span class="S10">.</span>frame<span class="S10">,</span><span class="S0"> </span>radius<span class="S10">=</span>wireradius<span class="S10">,</span><span class="S0"> </span>color<span class="S10">=</span>color<span class="S10">,</span><span class="S0"> </span><span class="S10">**</span>keywords<span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">for</span><span class="S0"> </span>x<span class="S0"> </span><span class="S5">in</span><span class="S0"> </span>visual<span class="S10">.</span>arange<span class="S10">(</span><span class="S2">0</span><span class="S10">,</span><span class="S0"> </span>length<span class="S0"> </span><span class="S10">+</span><span class="S0"> </span>dx<span class="S10">/</span><span class="S2">2.</span><span class="S10">,</span><span class="S0"> </span>dx<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>helix<span class="S10">.</span>append<span class="S10">(</span><span class="S0"> </span>pos<span class="S10">=(</span>x<span class="S10">,</span><span class="S0"> </span>radius<span class="S10">*</span>math<span class="S10">.</span>sin<span class="S10">(</span>k<span class="S10">*</span>x<span class="S10">),</span><span class="S0"> </span>radius<span class="S10">*</span>math<span class="S10">.</span>cos<span class="S10">(</span>k<span class="S10">*</span>x<span class="S10">))</span><span class="S0"> </span><span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>count<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>len<span class="S10">(</span>self<span class="S10">.</span>helix<span class="S10">.</span>pos<span class="S10">)</span><br />
<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">def</span><span class="S0"> </span><span class="S9">update</span><span class="S10">(</span>self<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S7">"""Update the visual representation of the spring.</span><br />
<span class="S7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>frame<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>frame<span class="S10">.</span>axis<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>self<span class="S10">.</span>m1<span class="S10">.</span>sphere<span class="S10">.</span>pos<span class="S0"> </span><span class="S10">-</span><span class="S0"> </span>self<span class="S10">.</span>m0<span class="S10">.</span>sphere<span class="S10">.</span>pos<br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>dx<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>visual<span class="S10">.</span>mag<span class="S10">(</span>self<span class="S10">.</span>frame<span class="S10">.</span>axis<span class="S10">)</span><span class="S0"> </span><span class="S10">/</span><span class="S0"> </span><span class="S10">(</span>self<span class="S10">.</span>count<span class="S10">-</span><span class="S2">1</span><span class="S10">)</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S5">for</span><span class="S0"> </span>index<span class="S0"> </span><span class="S5">in</span><span class="S0"> </span>range<span class="S10">(</span>self<span class="S10">.</span>count<span class="S10">):</span><br />
<span class="S0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>self<span class="S10">.</span>helix<span class="S10">.</span>x<span class="S10">[</span>index<span class="S10">]</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>index<span class="S0"> </span><span class="S10">*</span><span class="S0"> </span>dx<br />
<span class="S0"></span></span>
</body>
</html>
